package com.project;

import java.text.NumberFormat;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

public class Vaccine {
	
	// 3자리 수 마다 콤마찍기 (111,111)
	NumberFormat numberFormat = NumberFormat.getInstance();

	
	// 백신현황 공공API 데이터 가져오기 //
	public void vaccine() {

		try {

			DocumentBuilderFactory f = DocumentBuilderFactory.newInstance();
			DocumentBuilder parser = f.newDocumentBuilder();

			/*Document xmlDoc = null;*/

			String url = "https://nip.kdca.go.kr/irgd/cov19stats.do?list=all";

			Document xmlDoc = parser.parse(url);

			Element root = xmlDoc.getDocumentElement();

			Node body = root.getChildNodes().item(1);

			Node items = body.getChildNodes().item(3);

			Node item3 = items.getChildNodes().item(5);

			NodeList itemList = item3.getChildNodes();

			Node a1 = itemList.item(3); //1차백신 접종완료 인구
			Node b1 = itemList.item(5); //2차백신 접종완료 인구
			Node c1 = itemList.item(7); //3차백신 접종완료 인구

			String a = null;
			String b = null;
			String c = null;

			a = a1.getChildNodes().item(0).getNodeValue();
			b = b1.getChildNodes().item(0).getNodeValue();
			c = c1.getChildNodes().item(0).getNodeValue();

			// 총 인구
			double total = 51345000;
			
			// 천만 단위 콤마찍어주기
			String str = numberFormat.format(total);
			String vc1 = numberFormat.format(Double.parseDouble(a));
			String vc2 = numberFormat.format(Double.parseDouble(b));
			String vc3 = numberFormat.format(Double.parseDouble(c));

			
			System.out.printf("전체 인구 약 %s명 중\n", str);
			// 1차
			System.out.print("1차백신: " + vc1 + "명 ");

			System.out.printf("%.3g(%s)\n", Double.parseDouble(a) / 51345000 * 100, "%");
			// 2차
			System.out.print("2차백신: " + vc2 + "명 ");
			System.out.printf("%.3g(%s)\n", Double.parseDouble(b) / 51345000 * 100, "%");
			// 3차
			System.out.print("3차백신: " + vc3 + "명 ");
			System.out.printf("%.3g(%s)\n", Double.parseDouble(c) / 51345000 * 100, "%");

		} catch (Exception e) {
			System.out.println(e.toString());
		}

	}

}