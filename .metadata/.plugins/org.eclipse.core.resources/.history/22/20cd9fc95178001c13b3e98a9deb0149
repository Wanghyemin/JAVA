package com.project;

import java.io.InputStream;
import java.net.URL;
import java.util.Scanner;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

public class Covid{

	DocumentBuilder parser;
	int date;
	
	int a = 0;
	int b = 0;
	
	
	public void covid() {

		try {

			DocumentBuilderFactory f = DocumentBuilderFactory.newInstance();
			parser = f.newDocumentBuilder();

			

			
			// 날짜설정
			Scanner sc = new Scanner(System.in);
			

			do {
				System.out.println("날짜를 입력하세요[20220101]");
				date = sc.nextInt();
				
			} while (date < 20200101 || date > 20220119);

			
		} catch (Exception e) {
			System.out.println(e.toString());
		}
	}
	public void total() {
		
	try {
		
			// 당일자 URL형성
			String url = "http://openapi.data.go.kr/openapi/service/rest/Covid19"
					+ "/getCovid19InfStateJson?serviceKey=NCIUqcH3S7%2B53YimC1Rc"
					+ "H3h3AiFSpZrWZMfmjJGXFVZNGhf2BGW25igritgTfMcgMe4Gxd8qbS9nb%"
					+ "2F6%2BwBycXw%3D%3D&pageNo=1&numOfRows=10&" 
					+ "startCreateDt=" + date + "&endCreateDt=" + date;

			Document xmlDoc = null;
			xmlDoc = parser.parse(url);

			Element root = xmlDoc.getDocumentElement();

			Node body = root.getLastChild();

			Node items = body.getFirstChild();

			Node item = items.getFirstChild();

			NodeList itemList = item.getChildNodes();

			Node a1 = itemList.item(3);
			Node b1 = itemList.item(2);
			


			a = Integer.parseInt(a1.getChildNodes().item(0).getNodeValue());
			b = Integer.parseInt(b1.getChildNodes().item(0).getNodeValue());

			System.out.println("누적확진자: " + a + ",  누적사망자: " + b);

	} catch (Exception e) {
		System.out.println(e.toString());
	}
	}
			
	public void daily() {	
			
		
		try {
			// 전일자 URL형성
		String url = "http://openapi.data.go.kr/openapi/service/rest/Covid19"
					+ "/getCovid19InfStateJson?serviceKey=NCIUqcH3S7%2B53YimC1Rc"
					+ "H3h3AiFSpZrWZMfmjJGXFVZNGhf2BGW25igritgTfMcgMe4Gxd8qbS9nb%"
					+ "2F6%2BwBycXw%3D%3D&pageNo=1&numOfRows=10&" + "startCreateDt=" 
					+ (date - 1) + "&endCreateDt="
					+ (date - 1);
		
		Document xmlDoc = null;
			xmlDoc = parser.parse(url);

			Element root = xmlDoc.getDocumentElement();

			Node body = root.getLastChild();

			Node items = body.getFirstChild();

			Node item = items.getFirstChild();

			NodeList itemList = item.getChildNodes();


			Node c1 = itemList.item(3);
			Node d1 = itemList.item(2);

			int c = 0;
			int d = 0;

			c = Integer.parseInt(c1.getChildNodes().item(0).getNodeValue());
			d = Integer.parseInt(d1.getChildNodes().item(0).getNodeValue());

			System.out.println("일일확진자: " + (a - c) + ",  일일사망자: " + (b - d));

		} catch (Exception e) {
			System.out.println(e.toString());
		}

	}

}
